Разделение импорта на товары и товарные предложения. Из 1С приходят просто товары, но у них есть свойство "TORGOVOE_PREDLOZHENIE" которое вопреки названию содержит XML_ID родителя. Название свойства можно настраивать в настройках модуля в админке.

Код требует оптимизаций. И возможно доработок напильником.

